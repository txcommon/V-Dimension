<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title data-i18n="data.pageTitle">æ•°æ®ä¸­å¿ƒ</title>
	<link rel="icon" href="./favicon.ico" type="image/x-icon">
	<link rel="shortcut icon" href="./favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
	<style>
		* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
		body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'PingFang SC', 'Hiragino Sans GB', 'Microsoft YaHei', sans-serif; background: #0a0520; color: #fff; overflow-x: hidden; }
		
		/* ========== èƒŒæ™¯ä¼˜åŒ–ï¼šæé«˜å¯¹æ¯”åº¦ ========== */
		.bg-gradient { 
			position: fixed; 
			top: 0; 
			left: 0; 
			right: 0; 
			bottom: 0; 
			background: linear-gradient(135deg, #0a0520 0%, #14092f 50%, #23104b 100%); 
			z-index: -2; 
		}
		.bg-stars { 
			position: fixed; 
			top: 0; 
			left: 0; 
			right: 0; 
			bottom: 0; 
			background-image: radial-gradient(2px 2px at 20% 30%, rgba(255,255,255,0.2), transparent), 
							 radial-gradient(2px 2px at 60% 70%, rgba(168,85,247,0.25), transparent), 
							 radial-gradient(1px 1px at 50% 50%, rgba(255,255,255,0.15), transparent);
			background-size: 200% 200%; 
			opacity: 0.25;
			animation: twinkle 12s ease-in-out infinite; 
			z-index: -1; 
		}
		@keyframes twinkle { 0%, 100% { opacity: 0.25; } 50% { opacity: 0.15; } }
		
		/* ========== é¡¶éƒ¨æ  ========== */
		.top-bar { 
			display: flex; 
			justify-content: space-between; 
			align-items: center; 
			padding: 12px 20px; 
			background: rgba(26, 11, 61, 0.6); 
			backdrop-filter: blur(20px); 
			border-bottom: 1px solid rgba(168, 85, 247, 0.2); 
		}
		.nav-left { display: flex; align-items: center; gap: 12px; }
		.back-btn { 
			width: 36px; 
			height: 36px; 
			border-radius: 12px; 
			background: rgba(168, 85, 247, 0.15); 
			border: 1px solid rgba(168, 85, 247, 0.3); 
			color: #a855f7; 
			font-size: 18px; 
			display: flex; 
			align-items: center; 
			justify-content: center; 
			cursor: pointer; 
			transition: all 0.3s; 
		}
		.back-btn:active { transform: scale(0.95); }
		.page-title { 
			font-size: 18px; 
			font-weight: 700; 
			background: linear-gradient(135deg, #fb923c 0%, #f59e0b 100%); 
			-webkit-background-clip: text; 
			-webkit-text-fill-color: transparent; 
		}
		.refresh-btn { 
			padding: 8px 16px; 
			background: rgba(168, 85, 247, 0.15); 
			border: 1px solid rgba(168, 85, 247, 0.3); 
			border-radius: 12px; 
			color: #a855f7; 
			font-size: 14px; 
			font-weight: 600; 
			cursor: pointer; 
			transition: all 0.3s; 
			display: flex; 
			align-items: center; 
			gap: 6px; 
		}
		.refresh-btn:active { transform: scale(0.95); }
		.refresh-icon.spinning { animation: spin 0.5s linear; }
		@keyframes spin { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
		
		/* ========== å®¹å™¨å’Œæ•°æ®å¡ç‰‡ ========== */
		.container { padding: 20px; padding-bottom: 100px; }
		.data-card { 
			background: linear-gradient(135deg, rgba(168, 85, 247, 0.15) 0%, rgba(217, 70, 239, 0.15) 100%); 
			backdrop-filter: blur(20px); 
			border: 1px solid rgba(168, 85, 247, 0.3); 
			border-radius: 24px; 
			padding: 20px; 
			margin-bottom: 20px; 
			box-shadow: 0 10px 40px rgba(168, 85, 247, 0.2), inset 0 1px 0 rgba(255, 255, 255, 0.1); 
			position: relative; 
			overflow: hidden; 
		}
		.data-card::before { 
			content: ''; 
			position: absolute; 
			top: -50%; 
			left: -50%; 
			width: 200%; 
			height: 200%; 
			background: radial-gradient(circle, rgba(168, 85, 247, 0.1) 0%, transparent 70%); 
			animation: pulse 4s ease-in-out infinite; 
		}
		@keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.5; } 50% { transform: scale(1.1); opacity: 0.3; } }
		.card-content { position: relative; z-index: 1; }
		
		/* ========== å­—ä½“ä¼˜åŒ– ========== */
		.section-title { 
			font-size: 18px; 
			font-weight: 700; 
			color: #fff; 
			display: flex; 
			align-items: center; 
			gap: 8px; 
			margin-bottom: 18px; 
		}
		
		/* å¾½ç« ï¼šä¼˜åŒ–ä¸º13px */
		.section-badge { 
			padding: 4px 12px; 
			border-radius: 12px; 
			font-size: 13px; 
			font-weight: 600; 
			background: linear-gradient(135deg, rgba(168, 85, 247, 0.3) 0%, rgba(217, 70, 239, 0.3) 100%); 
			border: 1px solid rgba(168, 85, 247, 0.5); 
		}
		
		.stat-row { 
			display: flex; 
			justify-content: space-between; 
			align-items: center; 
			padding: 12px 0; 
			border-bottom: 1px solid rgba(255, 255, 255, 0.05); 
		}
		.stat-row:last-child { border-bottom: none; }
		
		/* æ•°æ®æ ‡ç­¾ï¼š15px */
		.stat-label { 
			font-size: 15px; 
			color: rgba(255, 255, 255, 0.8);
			font-weight: 500; 
		}
		
		/* æ•°æ®å€¼ï¼š16px */
		.stat-value { 
			font-size: 16px; 
			font-weight: 700; 
			color: #fff; 
		}
		
		.num-integer { font-weight: 700; }
		.num-decimal { 
			font-size: 13px; 
			font-weight: 400; 
			opacity: 0.9; 
		}
		.stat-orange { background: linear-gradient(135deg, #fb923c 0%, #f59e0b 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
		.stat-orange .num-decimal { background: linear-gradient(135deg, #fb923c 0%, #f59e0b 100%); -webkit-background-clip: text; -webkit-text-fill-color: transparent; opacity: 0.8; }
		.stat-purple { color: #a855f7; }
		.stat-purple .num-decimal { color: #a855f7; opacity: 0.8; }
		.stat-green { color: #10b981; }
		.divider { 
			height: 1px; 
			background: rgba(255, 255, 255, 0.05); 
			margin: 16px 0; 
		}
		
		/* ========== æ’åç½‘æ ¼ä¼˜åŒ–ï¼ˆ2åˆ—å¸ƒå±€ï¼‰ ========== */
		.rank-grid { 
			display: grid; 
			grid-template-columns: repeat(2, 1fr); 
			gap: 12px; 
			margin-bottom: 16px; 
		}
		.rank-box { 
			background: rgba(255, 255, 255, 0.03); 
			border: 1px solid rgba(255, 255, 255, 0.08); 
			border-radius: 14px; 
			padding: 12px; 
			text-align: center; 
		}
		
		/* æ’åæ ‡ç­¾ï¼š14px */
		.rank-box-label { 
			font-size: 14px; 
			color: rgba(255, 255, 255, 0.8); 
			margin-bottom: 6px; 
			font-weight: 600; 
		}
		
		/* æ’åå€¼ï¼š21px */
		.rank-box-value { 
			font-size: 21px; 
			font-weight: 800; 
			background: linear-gradient(135deg, #fb923c 0%, #f59e0b 100%); 
			-webkit-background-clip: text; 
			-webkit-text-fill-color: transparent; 
		}
		
		/* ========== å¾½ç« ä¼˜åŒ–ï¼ˆ5å±‚æ–°é…è‰²ï¼‰ ========== */
		.layer-badge { 
			display: inline-block; 
			padding: 4px 14px; 
			border-radius: 20px; 
			font-size: 13px; 
			font-weight: 700; 
			color: #fff; 
		}
		.badge-layer1 { background: linear-gradient(135deg, #FFD700 0%, #FFAA00 100%); color: #000; }
		.badge-layer2 { background: linear-gradient(135deg, #C0C0C0 0%, #A0A0A0 100%); color: #000; }
		.badge-layer3 { background: linear-gradient(135deg, #CD7F32 0%, #B56C1E 100%); color: #000; }
		.badge-layer4 { background: linear-gradient(135deg, #A855F7 0%, #8B5CF6 100%); color: #fff; }
		.badge-layer5 { background: linear-gradient(135deg, #3B82F6 0%, #1D4ED8 100%); color: #fff; }
		
		/* ========== å±‚å¡ç‰‡ä¼˜åŒ– ========== */
		.layer-card { 
			background: rgba(255, 255, 255, 0.03); 
			border: 1px solid rgba(255, 255, 255, 0.08); 
			border-radius: 16px; 
			padding: 16px; 
			margin-bottom: 12px; 
		}
		.layer-header { 
			display: flex; 
			justify-content: space-between; 
			align-items: center; 
			margin-bottom: 12px; 
		}
		.layer-name { 
			font-size: 16px; 
			font-weight: 700; 
			color: #fff; 
		}
		
		/* çŠ¶æ€å¾½ç« ï¼š13px */
		.layer-status-badge { 
			display: flex; 
			align-items: center; 
			gap: 6px; 
			font-size: 13px; 
			font-weight: 600; 
		}
		.layer-status-text { 
			color: rgba(255, 255, 255, 0.7); 
		}
		
		/* å¥–åŠ±ä¿¡æ¯ */
		.layer-reward { 
			padding: 8px 12px; 
			background: rgba(251, 191, 36, 0.1); 
			border-radius: 10px; 
			border: 1px solid rgba(251, 191, 36, 0.2); 
			margin: 8px 0; 
			font-size: 13px; 
			color: rgba(251, 191, 36, 0.9); 
			text-align: center; 
		}
		
		.layer-details { 
			display: grid; 
			grid-template-columns: repeat(2, 1fr); 
			gap: 8px; 
			margin-top: 12px; 
		}
		.detail-item { 
			background: rgba(255, 255, 255, 0.02); 
			border-radius: 10px; 
			padding: 8px; 
			text-align: center; 
		}
		.detail-label { 
			font-size: 12px; 
			color: rgba(255, 255, 255, 0.6); 
			margin-bottom: 4px; 
		}
		.detail-value { 
			font-size: 14px; 
			font-weight: 600; 
			color: #fff; 
		}
		
		/* ========== Tabåˆ‡æ¢ ========== */
		.tab-group { 
			display: flex; 
			gap: 8px; 
			margin-bottom: 16px; 
		}
		.tab-btn { 
			flex: 1; 
			padding: 10px; 
			background: rgba(255, 255, 255, 0.05); 
			border: 1px solid rgba(255, 255, 255, 0.1); 
			border-radius: 10px; 
			color: rgba(255, 255, 255, 0.6); 
			font-size: 13px; 
			font-weight: 600; 
			cursor: pointer; 
			transition: all 0.3s; 
		}
		.tab-btn.active { 
			background: linear-gradient(135deg, rgba(168, 85, 247, 0.3) 0%, rgba(217, 70, 239, 0.3) 100%); 
			border-color: rgba(168, 85, 247, 0.5); 
			color: #fff; 
		}
		.tab-content { display: none; }
		.tab-content.active { display: block; }
		
		/* ========== æ’ååˆ—è¡¨ ========== */
		.rank-list { max-height: 500px; overflow-y: auto; }
		.rank-item { 
			background: rgba(255, 255, 255, 0.03); 
			border: 1px solid rgba(255, 255, 255, 0.08); 
			border-radius: 12px; 
			padding: 14px; 
			margin-bottom: 8px; 
			display: flex; 
			align-items: center; 
			justify-content: space-between; 
			gap: 12px; 
		}
		.rank-number { 
			width: 36px; 
			height: 36px; 
			border-radius: 50%; 
			background: rgba(168, 85, 247, 0.2); 
			display: flex; 
			align-items: center; 
			justify-content: center; 
			font-size: 14px; 
			font-weight: 700; 
			color: #fff; 
			flex-shrink: 0; 
		}
		.rank-top1 { background: linear-gradient(135deg, #FFD700 0%, #FFAA00 100%); color: #000; }
		.rank-top2 { background: linear-gradient(135deg, #C0C0C0 0%, #A0A0A0 100%); color: #000; }
		.rank-top3 { background: linear-gradient(135deg, #CD7F32 0%, #B56C1E 100%); color: #000; }
		.rank-value { 
			font-size: 15px; 
			font-weight: 700; 
			background: linear-gradient(135deg, #fb923c 0%, #f59e0b 100%); 
			-webkit-background-clip: text; 
			-webkit-text-fill-color: transparent; 
		}
		.load-more-btn { 
			width: 100%; 
			padding: 12px; 
			background: linear-gradient(135deg, rgba(168, 85, 247, 0.2) 0%, rgba(217, 70, 239, 0.2) 100%); 
			border: 1px solid rgba(168, 85, 247, 0.4); 
			border-radius: 12px; 
			color: #a855f7; 
			font-size: 14px; 
			font-weight: 700; 
			cursor: pointer; 
			margin-top: 12px; 
		}
		.empty-state { 
			text-align: center; 
			padding: 40px 20px; 
			color: rgba(255, 255, 255, 0.5); 
		}
		.empty-icon { 
			font-size: 48px; 
			margin-bottom: 12px; 
			opacity: 0.5; 
		}
		.empty-text { 
			font-size: 14px; 
		}
		
		/* ========== çŠ¶æ€æç¤ºå¡ç‰‡ ========== */
		.status-card { 
			margin-top: 16px; 
			padding: 12px; 
			border-radius: 12px; 
			border: 1px solid; 
			font-size: 13px; 
			text-align: center; 
		}
		.status-info { 
			background: rgba(59, 130, 246, 0.1); 
			border-color: rgba(59, 130, 246, 0.2); 
			color: rgba(59, 130, 246, 0.9); 
		}
		.status-warning { 
			background: rgba(251, 191, 36, 0.1); 
			border-color: rgba(251, 191, 36, 0.2); 
			color: rgba(251, 191, 36, 0.9); 
		}
		.status-success { 
			background: rgba(34, 197, 94, 0.1); 
			border-color: rgba(34, 197, 94, 0.2); 
			color: rgba(34, 197, 94, 0.9); 
		}
		
		/* ========== åº•éƒ¨å¯¼èˆªï¼šä¿æŒå®Œå…¨åŸæ · ========== */
		.bottom-nav { 
			position: fixed; 
			bottom: 0; 
			left: 0; 
			right: 0; 
			display: flex; 
			justify-content: space-around; 
			padding: 12px 0 20px; 
			background: rgba(26, 11, 61, 0.8); 
			backdrop-filter: blur(20px); 
			border-top: 1px solid rgba(168, 85, 247, 0.2); 
			box-shadow: 0 -5px 30px rgba(0, 0, 0, 0.3); 
			z-index: 1000; 
		}
		.nav-item { 
			display: flex; 
			flex-direction: column; 
			align-items: center; 
			gap: 4px; 
			cursor: pointer; 
			padding: 8px 16px; 
			border-radius: 12px; 
			transition: all 0.3s; 
		}
		.nav-item.active { background: rgba(168, 85, 247, 0.15); }
		.nav-icon { 
			font-size: 24px; 
			transition: all 0.3s; 
		}
		.nav-item.active .nav-icon { color: #a855f7; transform: scale(1.1); }
		.nav-item:not(.active) .nav-icon { color: rgba(255, 255, 255, 0.4); }
		.nav-label { 
			font-size: 11px; 
			font-weight: 600; 
			transition: all 0.3s; 
		}
		.nav-item.active .nav-label { color: #a855f7; }
		.nav-item:not(.active) .nav-label { color: rgba(255, 255, 255, 0.4); }
		/* å¥–åŠ±ä¿¡æ¯æ ·å¼ */
		.reward-info {
		    display: flex;
		    align-items: center;
		    gap: 12px;
		    padding: 12px;
		    border-radius: 12px;
		    margin: 8px 0;
		}
		
		.reward-available {
		    background: rgba(251, 191, 36, 0.15);
		    border: 1px solid rgba(251, 191, 36, 0.3);
		    animation: pulse-glow 2s ease-in-out infinite;
		}
		
		.reward-full {
		    background: rgba(100, 116, 139, 0.1);
		    border: 1px solid rgba(100, 116, 139, 0.2);
		    opacity: 0.8;
		}
		
		.reward-icon {
		    font-size: 24px;
		    flex-shrink: 0;
		}
		
		.reward-details {
		    flex: 1;
		}
		
		.reward-amount {
		    font-size: 14px;
		    font-weight: 700;
		    color: #fff;
		    margin-bottom: 2px;
		}
		
		.reward-status {
		    font-size: 12px;
		    font-weight: 600;
		}
		
		.reward-available .reward-status {
		    color: rgba(251, 191, 36, 0.9);
		}
		
		.reward-full .reward-status {
		    color: rgba(148, 163, 184, 0.9);
		}
		
		.reward-tip {
		    font-size: 12px;
			font-weight: 550; /* åŠ ç²—å¢å¼ºå¯è¯»æ€§ */
		    color: rgba(255, 255, 255, 0.8);
		    text-align: center;
		    margin-top: 10px;
		    padding-top: 15px;
		    border-top: 2px solid rgba(255, 255, 255, 0.2);
			line-height: 1.5; /* å¢åŠ è¡Œé«˜ï¼Œæé«˜å¯è¯»æ€§ */
		}
		
		@keyframes pulse-glow {
		    0%, 100% { 
		        box-shadow: 0 0 0 0 rgba(251, 191, 36, 0.3); 
		    }
		    50% { 
		        box-shadow: 0 0 0 4px rgba(251, 191, 36, 0.1); 
		    }
		}
		/* åœ¨CSSéƒ¨åˆ†æ·»åŠ ï¼ˆå¤§çº¦åœ¨æœ€åï¼‰ */
		.pagination {
		    display: flex;
		    justify-content: center;
		    align-items: center;
		    gap: 10px;
		    margin: 15px 0 10px 0;
		}
		
		.pagination span {
		    color: rgba(255, 255, 255, 0.7);
		    font-size: 13px;
		    padding: 0 10px;
		}
		/* æ·»åŠ åˆ°CSSæ–‡ä»¶æœ«å°¾ */
		.rank-value .num-decimal {
		    font-size: 13px;
		    font-weight: 400;
		    background: linear-gradient(135deg, #fb923c 0%, #f59e0b 100%);
		    -webkit-background-clip: text;
		    -webkit-text-fill-color: transparent;
		    opacity: 0.8;
		}
	</style>
</head>
<body>
    <!-- ========== èƒŒæ™¯ ========== -->
    <div class="bg-gradient"></div>
    <div class="bg-stars"></div>
    
    <!-- ========== é¡¶éƒ¨æ  ========== -->
    <div class="top-bar">
        <div class="nav-left">
            <button class="back-btn" onclick="goBack()">â†</button>
            <div class="page-title">ğŸ“Š <span data-i18n="data.title">æ•°æ®ä¸­å¿ƒ</span></div>
        </div>
        <button class="refresh-btn" onclick="refreshData()">
            <span class="refresh-icon" id="refreshIcon">ğŸ”„</span>
            <span data-i18n="common.refresh">åˆ·æ–°</span>
        </button>
    </div>
    
    <!-- ========== ä¸»è¦å†…å®¹å®¹å™¨ ========== -->
    <div class="container">
        <!-- å…¨ç½‘ç»Ÿè®¡å¡ç‰‡ -->
        <div class="data-card">
            <div class="card-content">
                <div class="section-title"><span>ğŸŒ</span><span data-i18n="data.globalStats">å…¨ç½‘ç»Ÿè®¡</span></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.resonanceUsers">å…±æŒ¯äººæ•°</div><div class="stat-value stat-orange" id="globalUsers">0</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.totalCommunities">ç¤¾åŒºæ€»æ•°</div><div class="stat-value stat-purple" id="globalCommunities">0</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.totalMintedVollar">å…¨ç½‘é“¸é€  Vollar</div><div class="stat-value stat-orange" id="globalMinted">0</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.totalVIDResonance">å…¨ç½‘å…±æŒ¯ VID</div><div class="stat-value" id="globalVID">0</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.totalUSDTResonance">å…¨ç½‘å…±æŒ¯ USDT</div><div class="stat-value" id="globalUSDT">0</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.transferTax">å½“å‰è½¬è´¦ç¨ç‡</div><div class="stat-value" id="tokenTax">0%</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.interestRate">å½“å‰ç”Ÿæ¯åˆ©ç‡</div><div class="stat-value" id="interestRate">0%</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.contractRuntime">åˆçº¦è¿è¡Œæ—¶é—´</div><div class="stat-value" id="contractRuntime">0å¤© 0æ—¶ 0åˆ† 0ç§’</div></div>
            </div>
        </div>
        
        <!-- æˆ‘çš„æ•°æ®å¡ç‰‡ -->
        <div class="data-card">
            <div class="card-content">
                <div class="section-title"><span>ğŸ“ˆ</span><span data-i18n="data.myData">æˆ‘çš„æ•°æ®</span></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.totalMinted">æ€»é“¸é€  Vollar</div><div class="stat-value stat-orange" id="totalMinted">0</div></div>
                <div class="stat-row"><div class="stat-label">â”œâ”€ <span data-i18n="data.fromVID">VID å…±æŒ¯</span></div><div class="stat-value" id="vollarFromVID">0</div></div>
                <div class="stat-row"><div class="stat-label">â”œâ”€ <span data-i18n="data.fromUSDT">USDT å…±æŒ¯</span></div><div class="stat-value" id="vollarFromUSDT">0</div></div>
                <div class="stat-row"><div class="stat-label">â”œâ”€ <span data-i18n="data.fromInterest">æŒå¸ç”Ÿæ¯</span></div><div class="stat-value" id="vollarFromInterest">0</div></div>
                <div class="stat-row"><div class="stat-label">â””â”€ <span data-i18n="data.communitySubsidy">ç¤¾åŒºè¡¥è´´</span></div><div class="stat-value stat-purple" id="communitySubsidy">0</div></div>
                <div class="divider"></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.vidResonanceTotal">å…±æŒ¯ VID æ€»é¢</div><div class="stat-value" id="vidResonance">0</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.usdtResonanceTotal">å…±æŒ¯ USDT æ€»é¢</div><div class="stat-value" id="usdtResonance">0</div></div>
                <div class="divider"></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.refRewards">æ™®é€šæ¨èå¥–åŠ±</div><div class="stat-value stat-orange" id="refRewards">0</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.communityRewards">ç¤¾åŒºæ¨èå¥–åŠ±</div><div class="stat-value stat-purple" id="communityRewards">0</div></div>
                <div class="divider"></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.burnedVollar">å…‘æ¢é”€æ¯ Vollar</div><div class="stat-value stat-orange" id="burnedVollar">0</div></div>
                <div class="stat-row"><div class="stat-label">â”œâ”€ <span data-i18n="data.exchangedBNB">å…‘æ¢ BNB</span></div><div class="stat-value" id="exchangedBNB">0</div></div>
                <div class="stat-row"><div class="stat-label">â”œâ”€ <span data-i18n="data.exchangedUSDT">å…‘æ¢ USDT</span></div><div class="stat-value" id="exchangedUSDT">0</div></div>
                <div class="stat-row"><div class="stat-label">â””â”€ <span data-i18n="data.exchangedVID">å…‘æ¢ VID</span></div><div class="stat-value" id="exchangedVID">0</div></div>
                <div class="divider"></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.usdtForVID">USDT å…‘æ¢ VID</div><div class="stat-value" id="usdtForVID">0</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.getTotalVID">è·å¾— VID</div><div class="stat-value" id="getTotalVID">0</div></div>
            </div>
        </div>
        
        <!-- æˆ‘çš„å›¢é˜Ÿå¡ç‰‡ -->
        <div class="data-card">
            <div class="card-content">
                <div class="section-title"><span>ğŸ‘¥</span><span data-i18n="data.myTeam">æˆ‘çš„å›¢é˜Ÿ</span><span class="section-badge" id="teamBadge">0/0 ç”Ÿæ¯</span></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.myReferrer">æˆ‘çš„æ¨èäºº</div><div class="stat-value" id="myReferrer" style="font-size: 13px; font-family: 'Courier New', monospace;">-</div></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.referrerCommunity">æ¨èç¤¾åŒº</div><div class="stat-value" id="myReferrerCommunity" style="font-size: 13px; font-family: 'Courier New', monospace;">-</div></div>
                <div class="divider"></div>
                <div class="stat-row"><div class="stat-label" data-i18n="data.firstLevelCount">ä¸€çº§å›¢é˜Ÿäººæ•°</div><div class="stat-value stat-orange" id="totalFirstLevel">0</div></div>
                <div class="stat-row"><div class="stat-label">â”œâ”€ <span data-i18n="data.interestEnabled">å·²å¼€å¯ç”Ÿæ¯</span></div><div class="stat-value stat-green" id="activeInterest">0</div></div>
                <div class="stat-row"><div class="stat-label">â””â”€ <span data-i18n="data.interestDisabled">æœªå¼€å¯ç”Ÿæ¯</span></div><div class="stat-value" id="inactiveInterest">0</div></div>
            </div>
        </div>
        
        <!-- æˆ‘çš„ç¤¾åŒºæ’åå¡ç‰‡ -->
        <div class="data-card" id="rankingCard">
            <div class="card-content">
                <div class="section-title"><span>ğŸ†</span><span data-i18n="data.myCommunityRank">æˆ‘çš„ç¤¾åŒºæ’å</span><span class="section-badge" id="rankingBadge">åŠ è½½ä¸­...</span></div>
                
                <!-- çŠ¶æ€Aï¼šæœªæˆä¸ºç¤¾åŒº -->
                <div id="rankingStateA" style="display: none;">
                    <div style="text-align: center; padding: 20px 0;">
                        <div style="font-size: 14px; color: rgba(255, 255, 255, 0.6); margin-bottom: 16px;">ğŸ’¡ <span data-i18n="data.communityCondition">æˆä¸ºç¤¾åŒºæ¡ä»¶</span></div>
                        <div style="font-size: 16px; font-weight: 700; color: #fff; margin-bottom: 4px;" data-i18n="data.singleResonance">ä½¿ç”¨VIDå•æ¬¡å…±æŒ¯é“¸é€ </div>
                        <div style="font-size: 24px; font-weight: 800; margin-bottom: 20px;"><span class="stat-orange" id="communityFee">0</span> Vollar</div>
                        <div class="status-card status-info" data-i18n="data.communityTip">å…±æŒ¯VIDæˆä¸ºç¤¾åŒºï¼Œæ™‹çº§å…¨çƒæ’åç³»ç»Ÿï¼</div>
                    </div>
                </div>
                
                <!-- çŠ¶æ€Bï¼šç¤¾åŒºä½†æœªå…¥æ¦œ -->
                <div id="rankingStateB" style="display: none;">
                    <div class="stat-row"><div class="stat-label" data-i18n="data.currentPerformance">å½“å‰ä¸šç»©</div><div class="stat-value stat-orange" id="myPerformanceB">0</div></div>
                    <div class="stat-row"><div class="stat-label" data-i18n="data.rankThreshold">å…¥æ¦œé—¨æ§›</div><div class="stat-value stat-purple" id="top100Threshold">0</div></div>
                    <div class="stat-row"><div class="stat-label" data-i18n="data.gapToRank">è·ç¦»å…¥æ¦œ</div><div class="stat-value" id="gapToRanked">0</div></div>
                    <div class="status-card status-warning" data-i18n="data.rankTip">ğŸ’¡å…¥æ¦œå‰100åï¼Œäº«é«˜å€åŠ æˆå’Œå…‘æ¢å€ç‡ï¼</div>
                </div>
                
                <!-- çŠ¶æ€Cï¼šå·²å…¥æ¦œ -->
                <div id="rankingStateC" style="display: none;">
                    <div class="rank-grid">
                        <div class="rank-box"><div class="rank-box-label" data-i18n="data.globalRank">å…¨çƒæ’å</div><div class="rank-box-value" id="globalRank">-</div></div>
                        <div class="rank-box"><div class="rank-box-label" data-i18n="data.layerRank">å±‚å†…æ’å</div><div class="rank-box-value" id="layerRank">-</div></div>
                    </div>
                    <div class="stat-row"><div class="stat-label" data-i18n="data.currentLayer">æ‰€åœ¨å±‚çº§</div><div class="stat-value"><span class="layer-badge" id="layerBadge">-</span></div></div>
                    <div class="stat-row"><div class="stat-label" data-i18n="data.currentPerformance">å½“å‰ä¸šç»©</div><div class="stat-value stat-orange" id="myPerformanceC">0</div></div>
                    <div class="stat-row"><div class="stat-label" data-i18n="data.exchangeMultiplier">å…‘æ¢å€ç‡</div><div class="stat-value" id="exchangeRate">1x</div></div>
                    <div class="status-card status-success">ğŸ‰æ­å–œä¸Šæ¦œï¼æ™‹å‡æ›´é«˜å±‚è§£é”æ›´å¤šå¥–åŠ±ï¼</div>
                </div>
            </div>
        </div>
        
        <!-- ç¤¾åŒºæ’åçŠ¶æ€å¡ç‰‡ -->
        <div class="data-card">
            <div class="card-content">
                <div class="section-title"><span>ğŸ¯</span><span data-i18n="data.communityRankStatus">ç¤¾åŒºæ’åçŠ¶æ€</span><span class="section-badge" id="rankedCount">0/100</span></div>
                <div id="layersContainer"></div>
            </div>
        </div>
        
        <!-- ç¤¾åŒºæ’è¡Œæ¦œå¡ç‰‡ -->
        <div class="data-card">
            <div class="card-content">
                <div class="section-title"><span>ğŸ“Š</span><span data-i18n="data.communityLeaderboard">ç¤¾åŒºæ’è¡Œæ¦œ</span></div>
                <div class="tab-group">
                    <button class="tab-btn active" onclick="switchTab('performance')" data-i18n="data.performanceRank">ä¸šç»©æ’è¡Œ</button>
                    <button class="tab-btn" onclick="switchTab('minting')" data-i18n="data.mintingRank">é“¸é€ å¥–åŠ±</button>
                    <button class="tab-btn" onclick="switchTab('referral')" data-i18n="data.referralRank">æ¨èå¥–åŠ±</button>
                </div>
                <div class="tab-content active" id="performance"><div class="rank-list" id="performanceList"><div class="empty-state"><div class="empty-icon">ğŸ“Š</div><div class="empty-text" data-i18n="common.loading">æ­£åœ¨åŠ è½½...</div></div></div></div>
                <div class="tab-content" id="minting"><div class="rank-list" id="mintingList"><div class="empty-state"><div class="empty-icon">ğŸ’°</div><div class="empty-text" data-i18n="common.loading">æ­£åœ¨åŠ è½½...</div></div></div></div>
                <div class="tab-content" id="referral"><div class="rank-list" id="referralList"><div class="empty-state"><div class="empty-icon">ğŸ</div><div class="empty-text" data-i18n="common.loading">æ­£åœ¨åŠ è½½...</div></div></div></div>
            </div>
        </div>
    </div>
    
    <!-- ========== åº•éƒ¨å¯¼èˆª ========== -->
    <div class="bottom-nav">
        <div class="nav-item" onclick="switchPage('home')" data-page="home"><div class="nav-icon">ğŸ </div><div class="nav-label" data-i18n="nav.home">é¦–é¡µ</div></div>
        <div class="nav-item active" onclick="switchPage('stats')" data-page="stats"><div class="nav-icon">ğŸ“Š</div><div class="nav-label" data-i18n="nav.data">æ•°æ®</div></div>
        <div class="nav-item" onclick="switchPage('swap')" data-page="swap"><div class="nav-icon">ğŸ’°</div><div class="nav-label" data-i18n="nav.exchange">å…‘æ¢</div></div>
        <div class="nav-item" onclick="switchPage('temple')" data-page="temple"><div class="nav-icon">ğŸ›ï¸</div><div class="nav-label" data-i18n="nav.temple">åœ£æ®¿</div></div>
    </div>
    
    <script src="js/config.js"></script>
    <script src="js/web3-manager.js"></script>
    <script>
        // ========== å¸¸é‡é…ç½® ==========
        const TOTAL_RANKED_CAPACITY = 100; // æ€»å…¥æ¦œäººæ•°ï¼ˆ5å±‚åˆè®¡ï¼‰
        
        // 5å±‚æ’åç³»ç»Ÿé…ç½®
        const LAYER_NAMES = ['ğŸ¥‡ TOP 3', 'ğŸ¥ˆ TOP 10', 'ğŸ¥‰ TOP 30', 'ğŸ“ˆ TOP 60', 'ğŸ“Š TOP 100'];
        const LAYER_CAPACITIES = [3, 7, 20, 30, 40]; // åˆçº¦ä¸­çš„layerCapacities
        const LAYER_REWARDS = {
            1: '100,000 VID', // TOP 3
            2: '30,000 VID',  // TOP 10
            3: '10,000 VID',  // TOP 30
            4: '3,000 VID',   // TOP 60
            5: '1,000 VID'    // TOP 100
        };
        
        // å…‘æ¢å€ç‡æ˜ å°„ï¼ˆä»åˆçº¦_getCommunityRanking()å‡½æ•°ï¼‰
        const EXCHANGE_RATES = {
            0: '1x',      // æœªä¸Šæ¦œ
            1: '200x',    // TOP 3
            2: '100x',    // TOP 10
            3: '50x',     // TOP 30
            4: '20x',     // TOP 60
            5: '10x'      // TOP 100
        };
        
        let currentPage = { performance: 0, minting: 0, referral: 0 };
        let leaderboardLoaded = { performance: false, minting: false, referral: false };
        let totalCommunities = 0;
        let runtimeInterval = null;
        let contract = null;

        // ========== å·¥å…·å‡½æ•° ==========
        function formatNumberFull(num, decimals = 6) {
            if (decimals === 0) return Math.floor(num).toLocaleString();
            const actual = Number(num) / Math.pow(10, decimals);
            
            const rounded = actual.toFixed(decimals);
            const parts = rounded.split('.');
            
            let decimalPart = parts[1];
            if (decimalPart) {
                decimalPart = decimalPart.replace(/0+$/, '');
            }
            
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            
            if (!decimalPart) {
                return '<span class="num-integer">' + parts[0] + '</span>';
            }
            
            return '<span class="num-integer">' + parts[0] + '</span><span class="num-decimal">.' + decimalPart + '</span>';
        }

        function formatNumberShort(num, decimals = 6) {
            const actual = Number(num) / Math.pow(10, decimals);
            if (actual >= 1000000) { const v = (actual / 1000000).toFixed(2).split('.'); return '<span class="num-integer">' + v[0] + '</span><span class="num-decimal">.' + v[1] + '</span>M'; }
            if (actual >= 1000) { const v = (actual / 1000).toFixed(2).split('.'); return '<span class="num-integer">' + v[0] + '</span><span class="num-decimal">.' + v[1] + '</span>K'; }
            const v = actual.toFixed(2).split('.');
            return '<span class="num-integer">' + v[0] + '</span><span class="num-decimal">.' + v[1] + '</span>';
        }

        function formatNumber(num, decimals = 6, maxLength = 20) {
            const actual = Number(num) / Math.pow(10, decimals);
            const parts = actual.toFixed(2).split('.');
            parts[0] = parts[0].replace(/\B(?=(\d{3})+(?!\d))/g, ',');
            if (parts.join('.').length > maxLength) return formatNumberShort(num, decimals);
            return formatNumberFull(num, decimals);
        }

        function formatAddress(addr) {
            if (!addr || addr === '0x0000000000000000000000000000000000000000') return '-';
            return addr.slice(0, 6) + '...' + addr.slice(-6);
        }

        function updateContractRuntime(startTimestamp) {
            if (runtimeInterval) clearInterval(runtimeInterval);
            function update() {
                const elapsed = Math.floor(Date.now() / 1000) - Number(startTimestamp);
                const d = Math.floor(elapsed / 86400), h = Math.floor((elapsed % 86400) / 3600), m = Math.floor((elapsed % 3600) / 60), s = elapsed % 60;
                document.getElementById('contractRuntime').textContent = d + 'å¤© ' + h + 'æ—¶ ' + m + 'åˆ† ' + s + 'ç§’';
            }
            update();
            runtimeInterval = setInterval(update, 1000);
        }

        // ========== æ’åçŠ¶æ€æ˜¾ç¤º ==========
        function displayRankingState(ranking, globalRanking) {
            const stateA = document.getElementById('rankingStateA');
            const stateB = document.getElementById('rankingStateB');
            const stateC = document.getElementById('rankingStateC');
            const badge = document.getElementById('rankingBadge');
            
            stateA.style.display = 'none';
            stateB.style.display = 'none';
            stateC.style.display = 'none';
            
            if (!ranking.isCommunity) {
                // çŠ¶æ€Aï¼šæœªæˆä¸ºç¤¾åŒº
                stateA.style.display = 'block';
                badge.textContent = 'æœªæˆä¸ºç¤¾åŒº';
                document.getElementById('communityFee').innerHTML = formatNumberFull(globalRanking.communityMintingFee, 6);
            } else if (!ranking.isRanked) {
                // çŠ¶æ€Bï¼šç¤¾åŒºä½†æœªå…¥æ¦œ
                stateB.style.display = 'block';
                badge.textContent = 'æš‚æœªå…¥æ¦œ';
                
                const myPerf = Number(ranking.performance);
                // ç¬¬5å±‚é—¨æ§›å°±æ˜¯å…¥æ¦œé—¨æ§›
                const threshold = Number(globalRanking.thresholds?.[4] || 0);
                const gap = threshold > myPerf ? threshold - myPerf : 0;
                
                document.getElementById('myPerformanceB').innerHTML = formatNumber(myPerf, 6);
                document.getElementById('top100Threshold').innerHTML = formatNumber(threshold, 6);
                document.getElementById('gapToRanked').innerHTML = formatNumber(gap, 6);
            } else {
                // çŠ¶æ€Cï¼šå·²å…¥æ¦œ
                stateC.style.display = 'block';
                badge.textContent = 'æ­å–œå·²å…¥æ¦œ';
                
                document.getElementById('globalRank').textContent = '#' + ranking.globalRank;
                document.getElementById('layerRank').textContent = ranking.rankInLayer + '/' + ranking.layerTotal;
                document.getElementById('myPerformanceC').innerHTML = formatNumber(ranking.performance, 6);
                
                // å…‘æ¢å€ç‡
                document.getElementById('exchangeRate').textContent = EXCHANGE_RATES[ranking.layer] || '1x';
                
                // å±‚çº§å¾½ç« 
                const lb = document.getElementById('layerBadge');
                if (ranking.layer >= 1 && ranking.layer <= 5) {
                    lb.textContent = LAYER_NAMES[ranking.layer - 1];
                    lb.className = 'layer-badge badge-layer' + ranking.layer;
                } else {
                    lb.textContent = 'æœªä¸Šæ¦œ';
                    lb.className = 'layer-badge';
                }
            }
        }

        // ========== åŠ è½½å±‚çº§ä¿¡æ¯ ==========
		function loadLayersInfo(globalRanking) {
			const container = document.getElementById('layersContainer');
			container.innerHTML = '';
			
			const layerSizes = globalRanking.layerSizesArray || [];
			const thresholds = globalRanking.thresholds || [];
			
			for (let i = 0; i < 5; i++) {
				const layerIndex = i + 1;
				const layerSize = Number(layerSizes[i] || 0);
				const capacity = LAYER_CAPACITIES[i];
				const threshold = thresholds[i] || 0;
				const isFull = layerSize >= capacity;
				const reward = LAYER_REWARDS[layerIndex];
				const remainingSlots = capacity - layerSize;
				
				// é—¨æ§›åªæ˜¾ç¤ºæ•´æ•°
				const formattedThreshold = Math.floor(Number(threshold) / 1000000).toLocaleString();
				
				const card = document.createElement('div');
				card.className = 'layer-card';
				
				card.innerHTML = `
					<div class="layer-header">
						<div class="layer-name">${LAYER_NAMES[i]}</div>
						<div class="layer-status-badge">
							<span class="layer-status-text">${isFull ? 'å·²æ»¡å‘˜' : 'æœªæ»¡å‘˜'}</span>
							<span class="layer-badge badge-layer${layerIndex}">${layerSize}/${capacity}</span>
						</div>
					</div>
					
					<div class="reward-info ${isFull ? 'reward-full' : 'reward-available'}">
						<div class="reward-icon">${isFull ? 'â›”' : 'ğŸ'}</div>
						<div class="reward-details">
							<div class="reward-amount">${reward}</div>
							<div class="reward-status">${isFull ? 'å¥–åŠ±åé¢å·²æ»¡' : `${remainingSlots}ä¸ªå¥–åŠ±åé¢`}</div>
						</div>
					</div>
					
					<div class="layer-details">
						<div class="detail-item">
							<div class="detail-label">æ™‹çº§é—¨æ§›</div>
							<div class="detail-value">${formattedThreshold}</div>
						</div>
						<div class="detail-item">
							<div class="detail-label">å…‘æ¢å€ç‡</div>
							<div class="detail-value">${EXCHANGE_RATES[layerIndex]}</div>
						</div>
					</div>
					
					<!-- ğŸ”´ ä¿®æ”¹è¿™é‡Œçš„æ–‡å­—å†…å®¹å’Œæ ·å¼ -->
					${isFull ? 
						'<div class="reward-tip">âš ï¸ æœ¬å±‚åé¢å·²æ»¡ï¼Œæ™‹å‡æœ¬å±‚ä¸å†è·å¾—æ™‹çº§å¥–</div>' :
						'<div class="reward-tip">ğŸ’¡ æœ¬å±‚è¿˜æœ‰åé¢ï¼Œæ™‹å‡æœ¬å±‚å°†è·å¾—æ™‹çº§å¥–åŠ±</div>'
					}
				`;
				
				container.appendChild(card);
			}
		}

        // ========== åˆ›å»ºæ’åé¡¹ç›® ==========
		function createRankItem(rank, value, type) {
			const item = document.createElement('div');
			item.className = 'rank-item';
			
			let rankClass = 'rank-number';
			if (rank === 1) rankClass += ' rank-top1';
			else if (rank === 2) rankClass += ' rank-top2';
			else if (rank === 3) rankClass += ' rank-top3';
			
			const suffix = type === 'referral' ? ' VID' : ' Vollar';
			
			// âœ… å®Œå…¨ä¸å››èˆäº”å…¥ï¼Œç›´æ¥æˆªæ–­
			const actual = Number(value) / Math.pow(10, 6);
			
			// ç›´æ¥æˆªæ–­åˆ°2ä½å°æ•°ï¼ˆä¸å››èˆäº”å…¥ï¼‰
			const truncatedValue = Math.floor(actual * 100) / 100;
			
			const integerPart = Math.floor(truncatedValue);
			const decimalPart = Math.floor((truncatedValue - integerPart) * 100);
			
			const formattedInteger = integerPart.toLocaleString();
			
			let decimalHtml = '';
			if (decimalPart > 0) {
				const decimalStr = decimalPart.toString().padStart(2, '0');
				const trimmed = decimalStr.replace(/0+$/, '');
				decimalHtml = `<span class="num-decimal">.${trimmed}</span>`;
			}
			
			item.innerHTML = `
				<div class="${rankClass}">${rank}</div>
				<div class="rank-value">
					<span class="num-integer">${formattedInteger}</span>
					${decimalHtml}${suffix}
				</div>
			`;
			
			return item;
		}
        // ========== åŠ è½½æ’è¡Œæ¦œ ==========

		async function loadLeaderboard(type) {
			const listId = type + 'List';
			const container = document.getElementById(listId);
			
			try {
				// æ˜¾ç¤ºåŠ è½½çŠ¶æ€
				container.innerHTML = '<div class="empty-state"><div class="empty-icon">â³</div><div class="empty-text">æ­£åœ¨åŠ è½½æ’è¡Œæ¦œæ•°æ®...</div></div>';
				
				// 1. è·å–ç¤¾åŒºæ€»æ•°
				if (totalCommunities === 0) {
					totalCommunities = Number(await contract.methods.getMemberCount().call());
				}
				
				if (totalCommunities === 0) {
					container.innerHTML = '<div class="empty-state"><div class="empty-icon">ğŸ“Š</div><div class="empty-text">æš‚æ— æ•°æ®</div></div>';
					return;
				}
				
				// 2. æ ¹æ®æ•°æ®ç±»å‹è·å–å‚æ•°
				const dataType = type === 'performance' ? 1 : type === 'minting' ? 2 : 3;
				
				// 3. åˆ†æ‰¹è·å–æ‰€æœ‰æ•°æ®
				let allData = [];
				const BATCH_SIZE = 100; // æ¯æ¬¡å–100æ¡
				
				for (let start = 0; start < totalCommunities; start += BATCH_SIZE) {
					const end = Math.min(start + BATCH_SIZE, totalCommunities);
					
					// æ›´æ–°åŠ è½½è¿›åº¦
					const progress = Math.min(Math.floor((end / totalCommunities) * 100), 100);
					container.innerHTML = `<div class="empty-state"><div class="empty-icon">â³</div><div class="empty-text">æ­£åœ¨åŠ è½½æ•°æ®... ${progress}%</div></div>`;
					
					// è°ƒç”¨åˆçº¦è·å–è¿™ä¸€æ‰¹æ•°æ®
					const batchAmounts = await contract.methods.getCommunityData(dataType, start, end).call();
					
					// å°†è¿™æ‰¹æ•°æ®æ·»åŠ åˆ°æ€»æ•°ç»„
					batchAmounts.forEach((val, idx) => {
						allData.push({
							originalIndex: start + idx,
							value: Number(val)
						});
					});
				}
				
				// 4. å…¨å±€æ’åºï¼ˆä»é«˜åˆ°ä½ï¼‰
				allData.sort((a, b) => b.value - a.value);
				
				// 5. ç¼“å­˜æ•°æ®ï¼ˆç”¨äºåç»­æŸ¥çœ‹å®Œæ•´æ’è¡Œæ¦œï¼‰
				if (!window.leaderboardCache) window.leaderboardCache = {};
				window.leaderboardCache[type] = allData;
				
				// 6. æ¸…ç©ºå®¹å™¨å¹¶æ˜¾ç¤ºçœŸæ­£çš„å‰50å
				container.innerHTML = '';
				
				// è®¡ç®—å®é™…è¦æ˜¾ç¤ºçš„æ•°é‡ï¼ˆæœ€å¤š50æ¡ï¼‰
				const displayCount = Math.min(allData.length, 50);
				
				// 7. æ˜¾ç¤ºçœŸæ­£çš„å…¨çƒæ’è¡Œæ¦œ
				for (let i = 0; i < displayCount; i++) {
					const item = allData[i];
					const rank = i + 1; // è¿™æ‰æ˜¯çœŸæ­£çš„å…¨çƒæ’åï¼
					container.appendChild(createRankItem(rank, item.value, type));
				}
				
				// 8. å¦‚æœè¿˜æœ‰æ›´å¤šæ•°æ®ï¼Œæ˜¾ç¤º"æŸ¥çœ‹å®Œæ•´æ’è¡Œæ¦œ"æŒ‰é’®
				if (allData.length > displayCount) {
					const btn = document.createElement('button');
					btn.className = 'load-more-btn';
					btn.textContent = `æŸ¥çœ‹å®Œæ•´æ’è¡Œæ¦œ (å…±${allData.length}æ¡)`;
					btn.onclick = () => {
						showFullLeaderboard(type, allData);
					};
					container.appendChild(btn);
				}
				
				leaderboardLoaded[type] = true;
				
			} catch (error) {
				console.error('åŠ è½½æ’è¡Œæ¦œå¤±è´¥:', error);
				container.innerHTML = '<div class="empty-state"><div class="empty-icon">âš ï¸</div><div class="empty-text">åŠ è½½å¤±è´¥ï¼Œè¯·é‡è¯•</div></div>';
			}
		}

		// ========== æŸ¥çœ‹å®Œæ•´æ’è¡Œæ¦œå‡½æ•° ==========
		function showFullLeaderboard(type, allData) {
			const listId = type + 'List';
			const container = document.getElementById(listId);
			
			// æ¸…ç©ºå®¹å™¨
			container.innerHTML = '';
			
			// æ˜¾ç¤ºæ‰€æœ‰æ•°æ®ï¼ˆåˆ†é¡µæ˜¾ç¤ºï¼‰
			const PAGE_SIZE = 50;
			let currentPage = 0;
			
			function renderPage(pageNum) {
				const start = pageNum * PAGE_SIZE;
				const end = Math.min(start + PAGE_SIZE, allData.length);
				
				// æ¸…ç©ºå½“å‰å†…å®¹
				container.innerHTML = '';
				
				// æ¸²æŸ“è¿™ä¸€é¡µçš„æ•°æ®
				for (let i = start; i < end; i++) {
					const item = allData[i];
					const rank = i + 1; // å…¨å±€æ’å
					container.appendChild(createRankItem(rank, item.value, type));
				}
				
				// æ·»åŠ åˆ†é¡µæ§ä»¶
				if (allData.length > PAGE_SIZE) {
					const pagination = document.createElement('div');
					pagination.className = 'pagination';
					pagination.style.display = 'flex';
					pagination.style.justifyContent = 'center';
					pagination.style.alignItems = 'center';
					pagination.style.gap = '10px';
					pagination.style.marginTop = '15px';
					pagination.style.marginBottom = '10px';
					
					// ä¸Šä¸€é¡µæŒ‰é’®
					if (pageNum > 0) {
						const prevBtn = document.createElement('button');
						prevBtn.className = 'load-more-btn';
						prevBtn.style.padding = '8px 16px';
						prevBtn.style.fontSize = '13px';
						prevBtn.textContent = 'â† ä¸Šä¸€é¡µ';
						prevBtn.onclick = () => renderPage(pageNum - 1);
						pagination.appendChild(prevBtn);
					}
					
					// é¡µç æ˜¾ç¤º
					const pageInfo = document.createElement('span');
					pageInfo.style.color = 'rgba(255,255,255,0.7)';
					pageInfo.style.fontSize = '13px';
					pageInfo.style.padding = '0 10px';
					pageInfo.textContent = `${pageNum + 1}/${Math.ceil(allData.length / PAGE_SIZE)}`;
					pagination.appendChild(pageInfo);
					
					// ä¸‹ä¸€é¡µæŒ‰é’®
					if (end < allData.length) {
						const nextBtn = document.createElement('button');
						nextBtn.className = 'load-more-btn';
						nextBtn.style.padding = '8px 16px';
						nextBtn.style.fontSize = '13px';
						nextBtn.textContent = 'ä¸‹ä¸€é¡µ â†’';
						nextBtn.onclick = () => renderPage(pageNum + 1);
						pagination.appendChild(nextBtn);
					}
					
					container.appendChild(pagination);
				}
				
				// æ·»åŠ è¿”å›é¡¶éƒ¨æŒ‰é’®
				const backBtn = document.createElement('button');
				backBtn.className = 'load-more-btn';
				backBtn.textContent = 'ğŸ” è¿”å›å‰50å';
				backBtn.style.marginTop = '5px';
				backBtn.onclick = () => {
					// ä½¿ç”¨ç¼“å­˜æ•°æ®é‡æ–°åŠ è½½å‰50å
					if (window.leaderboardCache && window.leaderboardCache[type]) {
						const container = document.getElementById(listId);
						container.innerHTML = '';
						
						const displayCount = Math.min(window.leaderboardCache[type].length, 50);
						for (let i = 0; i < displayCount; i++) {
							const item = window.leaderboardCache[type][i];
							const rank = i + 1;
							container.appendChild(createRankItem(rank, item.value, type));
						}
						
						// é‡æ–°æ·»åŠ "æŸ¥çœ‹å®Œæ•´æ’è¡Œæ¦œ"æŒ‰é’®
						if (window.leaderboardCache[type].length > 50) {
							const btn = document.createElement('button');
							btn.className = 'load-more-btn';
							btn.textContent = `æŸ¥çœ‹å®Œæ•´æ’è¡Œæ¦œ (å…±${window.leaderboardCache[type].length}æ¡)`;
							btn.onclick = () => {
								showFullLeaderboard(type, window.leaderboardCache[type]);
							};
							container.appendChild(btn);
						}
					} else {
						// å¦‚æœæ²¡æœ‰ç¼“å­˜ï¼Œé‡æ–°åŠ è½½
						loadLeaderboard(type);
					}
				};
				container.appendChild(backBtn);
			}
			
			// æ¸²æŸ“ç¬¬ä¸€é¡µ
			renderPage(currentPage);
		}

        // ========== åŠ è½½æ•°æ® ==========
        async function loadData() {
            try {
                if (typeof web3Manager === 'undefined') {
                    console.log('ç­‰å¾…web3ManageråŠ è½½...');
                    setTimeout(loadData, 500);
                    return;
                }
                
                if (!web3Manager.web3) {
                    await web3Manager.init();
                }
                
                if (window.ethereum && window.ethereum.selectedAddress) {
                    web3Manager.account = window.ethereum.selectedAddress;
                    web3Manager.isConnected = true;
                }
                
                contract = web3Manager.getContract(TOKENBANK_ABI, CONFIG.CONTRACTS.TokenBank);
                
                if (!contract) {
                    console.error('æ— æ³•è·å–åˆçº¦å®ä¾‹');
                    return;
                }
                
                // åŠ è½½å…¨å±€æ•°æ®
                const globalStats = await contract.methods.getGlobalStats().call();
                const rateStats = await contract.methods.getRateStats().call();
                const globalRanking = await contract.methods.getGlobalRankingInfo().call();
                
                // æ›´æ–°å…¨å±€ç»Ÿè®¡
                document.getElementById('globalUsers').textContent = Number(globalStats.userCount).toLocaleString();
                document.getElementById('globalCommunities').textContent = Number(globalRanking.totalGlobalCommunities).toLocaleString();
                document.getElementById('globalMinted').innerHTML = formatNumber(globalStats.allTotalAmount, 6);
                document.getElementById('globalVID').innerHTML = formatNumber(globalStats.allTotalVIDResonance, 6) + ' VID';
                document.getElementById('globalUSDT').innerHTML = formatNumber(globalStats.allTotalUSDTResonance, 18) + ' USDT';
                document.getElementById('tokenTax').textContent = (Number(rateStats.tokenTax) / 100).toFixed(2) + '%';
                document.getElementById('interestRate').textContent = (Number(rateStats.interestRate) / 100).toFixed(2) + '%';
                
                updateContractRuntime(globalStats.startTimer);
                
                // æ›´æ–°æ’åçŠ¶æ€
                const totalRanked = Number(globalRanking.totalRankedCommunities);
                document.getElementById('rankedCount').textContent = `${totalRanked}/${TOTAL_RANKED_CAPACITY}`;
                
                // åŠ è½½å±‚çº§ä¿¡æ¯
                loadLayersInfo(globalRanking);
                totalCommunities = Number(globalRanking.totalGlobalCommunities);
                
                // åŠ è½½ç”¨æˆ·æ•°æ®ï¼ˆå¦‚æœå·²è¿æ¥é’±åŒ…ï¼‰
                if (web3Manager.account) {
                    console.log('å·²è¿æ¥é’±åŒ…:', web3Manager.account);
                    
                    const userInfo = await contract.methods.getUserInfo().call({ from: web3Manager.account });
                    document.getElementById('totalMinted').innerHTML = formatNumber(userInfo.totalMintedVollar, 6);
                    document.getElementById('vollarFromVID').innerHTML = formatNumber(userInfo.vollarFromVID, 6);
                    document.getElementById('vollarFromUSDT').innerHTML = formatNumber(userInfo.vollarFromUSDT, 6);
                    document.getElementById('vollarFromInterest').innerHTML = formatNumber(userInfo.personalHoldingInterest, 6);
                    document.getElementById('communitySubsidy').innerHTML = formatNumber(userInfo.communitySubsidyMint, 6);
                    document.getElementById('vidResonance').innerHTML = formatNumber(userInfo.vidResonanceAmount, 6) + ' VID';
                    document.getElementById('usdtResonance').innerHTML = formatNumber(userInfo.usdtResonanceAmount, 18) + ' USDT';
                    document.getElementById('refRewards').innerHTML = formatNumber(userInfo.vidRewardsFromRef, 6) + ' VID';
                    document.getElementById('communityRewards').innerHTML = formatNumber(userInfo.vidRewardsFromCommunity, 6) + ' VID';
                    document.getElementById('burnedVollar').innerHTML = formatNumber(userInfo.exchangedBurnedVollar, 6);
                    document.getElementById('exchangedBNB').innerHTML = formatNumber(userInfo.exchangedBNB, 18) + ' BNB';
                    document.getElementById('exchangedUSDT').innerHTML = formatNumber(userInfo.exchangedUSDT, 18) + ' USDT';
                    document.getElementById('exchangedVID').innerHTML = formatNumber(userInfo.exchangedVID, 6) + ' VID';
                    document.getElementById('usdtForVID').innerHTML = formatNumber(userInfo.usdtForVIDAmount, 18) + ' USDT';
                    document.getElementById('getTotalVID').innerHTML = formatNumber(userInfo.getTotalVID, 6) + ' VID';
                    
                    const refStatus = await contract.methods.getUserRefInterestStatus().call({ from: web3Manager.account });
                    document.getElementById('myReferrer').textContent = formatAddress(refStatus.myReferrer);
                    document.getElementById('myReferrerCommunity').textContent = formatAddress(refStatus.myReferrerCommunity);
                    document.getElementById('totalFirstLevel').textContent = Number(refStatus.totalFirstLevelMembers);
                    document.getElementById('activeInterest').textContent = Number(refStatus.activeInterestCount);
                    document.getElementById('inactiveInterest').textContent = Number(refStatus.totalFirstLevelMembers) - Number(refStatus.activeInterestCount);
                    document.getElementById('teamBadge').textContent = `${refStatus.activeInterestCount}/${refStatus.totalFirstLevelMembers} ç”Ÿæ¯`;
                    
                    const rankingInfo = await contract.methods.getUserRankingInfo().call({ from: web3Manager.account });
                    const isCommunity = await contract.methods.amICommunityMember().call({ from: web3Manager.account });
                    
                    displayRankingState({
                        isCommunity,
                        isRanked: rankingInfo.isRanked,
                        globalRank: Number(rankingInfo.globalRank),
                        layer: Number(rankingInfo.layer),
                        performance: rankingInfo.performance,
                        rankInLayer: Number(rankingInfo.rankInLayer),
                        layerTotal: Number(rankingInfo.layerTotal),
                        exchangeRate: Number(rankingInfo.exchangeRate)
                    }, globalRanking);
                } else {
                    console.log('é’±åŒ…æœªè¿æ¥');
                    document.getElementById('rankingBadge').textContent = 'æœªè¿æ¥é’±åŒ…';
                    document.getElementById('rankingStateA').style.display = 'block';
                    document.getElementById('communityFee').innerHTML = formatNumberFull(globalRanking.communityMintingFee, 6);
                }
                
                // åŠ è½½æ’è¡Œæ¦œ
                loadLeaderboard('performance');
                console.log('æ•°æ®åŠ è½½å®Œæˆ');
            } catch (error) {
                console.error('åŠ è½½æ•°æ®å¤±è´¥:', error);
            }
        }

        // ========== ç•Œé¢æ§åˆ¶å‡½æ•° ==========
        function switchTab(type) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(type).classList.add('active');

			loadLeaderboard(type);
        }

        function switchPage(page) {
            const pages = {
                'home': 'index.html',
                'stats': 'data.html',
                'swap': 'exchange.html',
                'temple': 'temple.html'
            };
            
            if (pages[page]) {
                window.location.href = pages[page];
            }
        }

		// æ‰¾åˆ° refreshData() å‡½æ•°ï¼ˆå¤§çº¦åœ¨ç¬¬380è¡Œï¼‰
		function refreshData() {
			const icon = document.getElementById('refreshIcon');
			icon.classList.add('spinning');
			
			currentPage = { performance: 0, minting: 0, referral: 0 };
			leaderboardLoaded = { performance: false, minting: false, referral: false };
			totalCommunities = 0;
			
			// âœ… æ–°å¢ï¼šæ¸…é™¤æ’è¡Œæ¦œç¼“å­˜
			if (window.leaderboardCache) {
				window.leaderboardCache = {};
			}
			
			setTimeout(() => {
				icon.classList.remove('spinning');
				loadData();
			}, 500);
		}

        function goBack() {
            window.history.back();
        }

        // ========== åˆå§‹åŒ– ==========
        window.onload = function() {
            setTimeout(loadData, 100);
        };
    </script>
</body>
</html>
